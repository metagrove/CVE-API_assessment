<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CVE Vulnerabilities</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        table, th, td {
            border: 1px solid black;
        }
        th, td {
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #f2f2f2;
        }
        .clickable-row {
            cursor: pointer;
        }
        .clickable-row:hover {
            background-color: #f5f5f5;
        }
        #cveDetails {
            display: none;
            margin-top: 20px;
        }
        .pagination {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
        }
        .pagination button {
            padding: 5px 10px;
            cursor: pointer;
        }
    </style>
</head>
<body>

    <h1>CVE Vulnerabilities List</h1>

    <table id="cveTable">
        <thead>
            <tr>
                <th>CVE ID</th>
                <th>Identifier</th>
                <th>Publish Date</th>
                <th>Last Modified Date</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody id="tableRows"></tbody>        
    </table>
    <div class="pagination">
        <div>
            <label for="pageSize">Results per page:</label>
            <select id="pageSize">
                <option value="10">10</option>
                <option value="50">50</option>
                <option value="100">100</option>
            </select>
        </div>
        <div>
            <button id="prevPage">Previous</button>
            <span id="currentPage"></span>
            <button id="nextPage">Next</button>
        </div>
        <div id="totalRecords"></div>
    </div>

    <div id="cveDetails">
        <h2 id="cveTitle"></h2>
        <p id="cveDescription"></p>
        <h3>CVSS V2 Metrics:</h3>
        <p><strong>Severity:</strong> <span id="cveSeverity"></span></p>
        <p><strong>Score:</strong> <span id="cveScore"></span></p>
        <p><strong>Vector String:</strong> <span id="cveVectorString"></span></p>
        <table id="cveMetricsTable">
            <tr>
                <th>Access Vector</th>
                <th>Access Complexity</th>
                <th>Authentication</th>
                <th>Confidentiality Impact</th>
                <th>Integrity Impact</th>
                <th>Availability Impact</th>
            </tr>
            <tr id="cveMetricsRow"></tr>
        </table>
        <h3>Scores:</h3>
        <p><strong>Exploitability Score:</strong> <span id="cveExploitabilityScore"></span></p>
        <p><strong>Impact Score:</strong> <span id="cveImpactScore"></span></p>
        <h3>CPE:</h3>
        <table id="cpeCriteriaTable">
            <tr>
                <th>Criteria</th>
                <th>Match Criteria ID</th>
                <th>Vulnerable</th>
            </tr>
        </table>
        <button id="backToList">Back to List</button>
    </div>

    <script>
    // Base URL of the API
    const apiUrl = 'https://services.nvd.nist.gov/rest/json/cves/2.0';

    // DOM Elements
    const tableBody = document.getElementById('tableRows');
    const pageSizeSelect = document.getElementById('pageSize');
    const totalRecordsDisplay = document.getElementById('totalRecords');
    const cveDetailsDiv = document.getElementById('cveDetails');
    const prevPageBtn = document.getElementById('prevPage');
    const nextPageBtn = document.getElementById('nextPage');
    const currentPageSpan = document.getElementById('currentPage');
    const backToListBtn = document.getElementById('backToList');

    // Pagination state
    let currentPage = 1;
    let pageSize = 10;
    let totalRecords = 0;

    // Fetch CVE data from the API
    async function fetchCVEData(page, limit) {
        try {
            const response = await fetch(`${apiUrl}?startIndex=${(page - 1) * limit}&resultsPerPage=${limit}`);
            const data = await response.json();
            populateTable(data.vulnerabilities);
            totalRecords = data.totalResults;
            totalRecordsDisplay.textContent = `Total Records: ${totalRecords}`;
            updatePagination();
        } catch (error) {
            console.error('Error fetching data:', error);
        }
    }

    // Populate table with CVE data
    function populateTable(vulnerabilities) {
        tableBody.innerHTML = ''; // Clear previous table rows

        vulnerabilities.forEach(vuln => {
            const row = document.createElement('tr');
            row.classList.add('clickable-row');
            
            row.setAttribute('data-cve-id', vuln.cve.id);
            row.addEventListener('click', () => showCVEDetails(vuln.cve.id));

            row.innerHTML = `
                <td>${vuln.cve.id}</td>
                <td>${vuln.cve.sourceIdentifier}</td>
                <td>${formatDate(vuln.cve.published)}</td>
                <td>${formatDate(vuln.cve.lastModified)}</td>
                <td>${vuln.cve.vulnStatus}</td>
            `;

            tableBody.appendChild(row);
        });
    }

    // Format the date from the API response
    function formatDate(dateString) {
        const date = new Date(dateString);
        const day = String(date.getDate()).padStart(2, '0');
        const monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
        const month = monthNames[date.getMonth()];
        const year = date.getFullYear();

        return `${day} ${month} ${year}`;
    }

    // Show CVE details
    async function showCVEDetails(cveId) {
        try {
            const response = await fetch(`${apiUrl}?cveId=${cveId}`);
            const data = await response.json();
            const cve = data.vulnerabilities[0].cve;

            document.getElementById('cveTitle').textContent = cve.id;
            document.getElementById('cveDescription').textContent = cve.descriptions[0].value;
            
            const metrics = cve.metrics.cvssMetricV2[0];
            document.getElementById('cveSeverity').textContent = metrics.baseSeverity;
            document.getElementById('cveScore').textContent = metrics.cvssData.baseScore;
            document.getElementById('cveVectorString').textContent = metrics.cvssData.vectorString;

            const metricsRow = document.getElementById('cveMetricsRow');
            metricsRow.innerHTML = `
                <td>${metrics.cvssData.accessVector}</td>
                <td>${metrics.cvssData.accessComplexity}</td>
                <td>${metrics.cvssData.authentication}</td>
                <td>${metrics.cvssData.confidentialityImpact}</td>
                <td>${metrics.cvssData.integrityImpact}</td>
                <td>${metrics.cvssData.availabilityImpact}</td>
            `;

            document.getElementById('cveExploitabilityScore').textContent = metrics.exploitabilityScore;
            document.getElementById('cveImpactScore').textContent = metrics.impactScore;

            const cpeCriteriaTable = document.getElementById('cpeCriteriaTable');
            cpeCriteriaTable.innerHTML = '<tr><th>Criteria</th><th>Match Criteria ID</th><th>Vulnerable</th></tr>';
            cve.configurations[0].nodes[0].cpeMatch.forEach(cpe => {
                const row = cpeCriteriaTable.insertRow();
                row.insertCell().textContent = cpe.criteria;
                row.insertCell().textContent = cpe.matchCriteriaId;
                row.insertCell().textContent = cpe.vulnerable ? 'Yes' : 'No';
            });

            cveDetailsDiv.style.display = 'block';
            document.getElementById('cveTable').style.display = 'none';
            document.querySelector('.pagination').style.display = 'none';
        } catch (error) {
            console.error('Error fetching CVE details:', error);
        }
    }

    // Update pagination
    function updatePagination() {
        const totalPages = Math.ceil(totalRecords / pageSize);
        currentPageSpan.textContent = `Page ${currentPage} of ${totalPages}`;
        prevPageBtn.disabled = currentPage === 1;
        nextPageBtn.disabled = currentPage === totalPages;
    }

    // Event listeners
    pageSizeSelect.addEventListener('change', () => {
        pageSize = parseInt(pageSizeSelect.value);
        currentPage = 1;
        fetchCVEData(currentPage, pageSize);
    });

    prevPageBtn.addEventListener('click', () => {
        if (currentPage > 1) {
            currentPage--;
            fetchCVEData(currentPage, pageSize);
        }
    });

    nextPageBtn.addEventListener('click', () => {
        const totalPages = Math.ceil(totalRecords / pageSize);
        if (currentPage < totalPages) {
            currentPage++;
            fetchCVEData(currentPage, pageSize);
        }
    });

    backToListBtn.addEventListener('click', () => {
        cveDetailsDiv.style.display = 'none';
        document.getElementById('cveTable').style.display = 'table';
        document.querySelector('.pagination').style.display = 'flex';
    });

    // Initial fetch
    fetchCVEData(currentPage, pageSize);
    </script>
</body>
</html>








